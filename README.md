![Build](https://img.shields.io/appveyor/build/aegzorz/stilleben)
![License](https://img.shields.io/github/license/aegzorz/stilleben)
![Version](https://img.shields.io/github/v/release/aegzorz/stilleben)

# Stilleben

Modern snapshot testing written in Swift.

Used to for testing snapshots of mostly UI components but also models and other types.

It comes with a few predefined matchers:
- `UIMatcher` for SwiftUI and UIKit snapshots.
- `EncodableMatcher` for snapshots of models encoded to JSON.
- `ReflectionMatcher` for snapshots of any type in the form of a reflection description.

Snapshots can be configured to use the following:
- `RecordingStrategy` determines how snapshots are saved and read.
- `DiffingStrategy` how to diff the recorded snapshot against the one generated by the test.
- `RenderingStrategy` strategy used for rendering UI snapshots.
- `SizingStrategy` strategy used for sizing views before snapshotting.

## Examples

Example of snapshot testing a SwiftUI view:
```swift
import XCTest
import Stilleben

final class SomeViewTests: XCTestCase {
    private let matcher = UIMatcher()
        .assertSimulator(modelIdentifier: "iPhone14,7")
        .sizing(.dynamicHeight)
        .dynamicTypeSizes(.large)

    func testSomeView() async throws {
        await matcher
            .colorSchemes(.light)
            .match {
                NavigationView {
                    SomeView()
                }
            }
    }
}
```

<details>
    <summary>Generated snapshot</summary>
    <img src="https://user-images.githubusercontent.com/810539/202294178-d2cbc7b4-fe3c-409e-8d2c-d445a100f8c0.png" width="200px">
</details>

It also supports snapshot testing UIKit view controllers or views:

```swift
import XCTest
import Stilleben

final class SomeViewControllerTests: XCTestCase {
    private let matcher = UIMatcher()
        .assertSimulator(modelIdentifier: "iPhone14,7")
        .sizing(.screen)
    
    func testSomeViewController() async throws {
        await matcher
            .match { @MainActor () -> UIViewController in
                SomeViewController()
            }
    }
    
    func testSomeView() async throws {
        await matcher
            .sizing(.intrinsic)
            .match { @MainActor () -> UIView in
                SomeView()
            }
    }
}
```
