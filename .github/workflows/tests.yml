name: Tests

on:
  push:
    branches: [develop]
  pull_request:
    branches: ["**"]

env:
  DEVELOPER_DIR: /Applications/Xcode-14.0.1.app/Contents/Developer
  NSUnbufferedIO: YES
  
jobs:
  Tests:
    runs-on: self-hosted
    steps:
      - name: Checkout ğŸ‘€
        uses: actions/checkout@v3
        with:
          token: ${{ github.token }}
          ssh-key: ''
      - name: Fix PATH ğŸ—º
        run: | 
            echo "/opt/homebrew/bin" >> $GITHUB_PATH
      - name: Homebrew ğŸº
        run: |
          brew bundle
      - name: Test âœ…
        run: |
          make test
      - name: Report ğŸ“
        uses: kishikawakatsumi/xcresulttool@v1
        with:
          path: TestResults.xcresult
        if: success() || failure()
